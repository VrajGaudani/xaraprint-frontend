<!-- Top Promotional Bar with Unique Design -->
<div class="promo-bar bg-gradient-primary text-white py-2 position-relative overflow-hidden">
  <div class="promo-bg-pattern"></div>
  <div class="container-fluid position-relative">
    <div class="row align-items-center">
      <div class="col-md-8">
        <div class="d-flex align-items-center">
          <div class="shipping-icon-wrapper me-3">
            <i class="bi bi-truck fs-5"></i>
          </div>
          <div class="shipping-text">
            <span class="fw-bold">FREE SUPER SAVER SHIPPING</span>
            <span class="shipping-condition ms-2">over $99</span>
          </div>
        </div>
      </div>
      <div class="col-md-4 text-end">
        <div class="d-flex align-items-center justify-content-end gap-3">
          <div class="offer-text">
            <span class="text-warning fw-bold">Up to 30% Off Sitewide.</span>
            <span class="ms-1">Use Code: <span class="code-highlight">IDPREP</span></span>
          </div>
          <div class="countdown-timer d-flex gap-1">
            <div class="time-unit">
              <span class="time-value">01</span>
              <span class="time-label">D</span>
            </div>
            <span class="time-separator">:</span>
            <div class="time-unit">
              <span class="time-value">07</span>
              <span class="time-label">H</span>
            </div>
            <span class="time-separator">:</span>
            <div class="time-unit">
              <span class="time-value">17</span>
              <span class="time-label">M</span>
            </div>
            <span class="time-separator">:</span>
            <div class="time-unit">
              <span class="time-value">27</span>
              <span class="time-label">S</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Top Bar with Improved Dropdowns -->
<div class="topbar bg-light border-bottom py-2">
  <div class="container-fluid">
    <div class="row align-items-center">
      <div class="col-md-6">
        <div class="d-flex align-items-center gap-4">
          <div class="dropdown custom-dropdown">
            <button class="btn btn-link p-0 text-decoration-none dropdown-toggle custom-dropdown-toggle" 
                    data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-list me-1"></i>
              <span class="fw-semibold">Quick Links</span>
            </button>
            <ul class="dropdown-menu custom-dropdown-menu shadow-lg">
              <li>
                <a class="dropdown-item custom-dropdown-item" href="/track-order">
                  <i class="bi bi-box-seam me-2"></i>
                  <span>Track Order</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item custom-dropdown-item" href="/design-templates">
                  <i class="bi bi-palette me-2"></i>
                  <span>Design Templates</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item custom-dropdown-item" href="/bulk-orders">
                  <i class="bi bi-stack me-2"></i>
                  <span>Bulk Orders</span>
                </a>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item custom-dropdown-item" href="/help">
                  <i class="bi bi-question-circle me-2"></i>
                  <span>Help Center</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="d-flex align-items-center justify-content-end gap-3">
          <!-- User Account Section -->
          <div class="dropdown custom-dropdown" *ngIf="gs.isLogin">
            <a class="dropdown-toggle custom-dropdown-toggle text-decoration-none d-flex align-items-center" 
               href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-person-circle me-1"></i>
              <span>Hi, {{profileData?.firstname}}</span>
            </a>
            <ul class="dropdown-menu custom-dropdown-menu shadow-lg">
              <li>
                <a class="dropdown-item custom-dropdown-item" routerLink="/account">
                  <i class="bi bi-person me-2"></i>
                  <span>My Account</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item custom-dropdown-item" routerLink="/orders">
                  <i class="bi bi-bag me-2"></i>
                  <span>My Orders</span>
                </a>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item custom-dropdown-item" (click)="logout()">
                  <i class="bi bi-box-arrow-right me-2"></i>
                  <span>Logout</span>
                </a>
              </li>
            </ul>
          </div>
          
          <div *ngIf="!gs.isLogin">
            <a routerLink="/login" class="text-dark text-decoration-none d-flex align-items-center">
              <i class="bi bi-person-circle me-1"></i>
              <span>Login/Register</span>
            </a>
          </div>

          <!-- Cart -->
          <a routerLink="/cart" class="text-dark text-decoration-none d-flex align-items-center">
            <i class="bi bi-bag me-1"></i>
            <span>Item(s) <span class="fw-bold">${{finalPrice}}</span></span>
          </a>

          <!-- Country Selector -->
          <div class="dropdown custom-dropdown">
            <a class="dropdown-toggle custom-dropdown-toggle text-decoration-none d-flex align-items-center" 
               href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <img src="assets/images/usa.svg" alt="usa" width="20" height="15" class="me-1" />
              <span class="small">US</span>
            </a>
            <ul class="dropdown-menu custom-dropdown-menu shadow-lg">
              <li>
                <a class="dropdown-item custom-dropdown-item" href="#">
                  <img src="assets/images/uk.svg" alt="uk" width="20" class="me-2" />
                  <span>United Kingdom</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item custom-dropdown-item" href="#">
                  <img src="assets/images/au.svg" alt="au" width="20" class="me-2" />
                  <span>Australia</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item custom-dropdown-item" href="#">
                  <img src="assets/images/ca.svg" alt="ca" width="20" class="me-2" />
                  <span>Canada</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Main Header with Fixed Search -->
<header class="main-header bg-white py-3 shadow-sm">
  <div class="container-fluid">
    <div class="row align-items-center">
      <!-- Logo -->
      <div class="col-lg-2 col-md-3 col-6">
        <a routerLink="/home" class="navbar-brand">
          <img src="assets/images/logo.svg" alt="BannerBuzz" class="logo" height="45" />
        </a>
      </div>

      <!-- Search Bar - Fixed Dropdown Issue -->
      <div class="col-lg-6 col-md-5 col-12 order-lg-2 order-3 mt-2 mt-lg-0">
        <div class="search-container position-relative">
          <div class="search-wrapper">
            <input type="text" 
                   [formControl]="searchControl" 
                   placeholder="Search for Banners, Signs, Displays..." 
                   class="form-control search-input"
                   (focus)="showSearchDropdown = true"
                   (blur)="hideSearchDropdown()" />
            <button class="btn btn-primary search-btn" type="button">
              <i class="bi bi-search"></i>
            </button>
          </div>
          <!-- Fixed Search Dropdown -->
          <div class="search-results-dropdown" 
               *ngIf="showSearchDropdown && searchProductList.length > 0"
               [class.show]="showSearchDropdown">
            <div class="search-results-header">
              <h6 class="mb-0 fw-bold">Quick Access</h6>
            </div>
            <div class="search-results-body">
              <div class="row g-2">
                <div class="col-4" *ngFor="let item of searchProductList.slice(0, 6)">
                  <a [routerLink]="'/product-details/' + item._id" 
                     class="search-result-item"
                     (mousedown)="selectSearchItem(item)">
                    <div class="search-result-image">
                      <img [src]="item?.product_images[0]" [alt]="item?.productname" />
                    </div>
                    <p class="search-result-title">{{item?.productname}}</p>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Contact & Actions - Fixed Layout -->
      <div class="col-lg-4 col-md-4 col-6 order-lg-3 order-2">
        <div class="header-actions d-flex align-items-center justify-content-end">
          <div class="contact-buttons d-none d-md-flex">
            <div class="contact-item">
              <div class="contact-icon">
                <i class="bi bi-chat-dots"></i>
              </div>
              <div class="contact-info">
                <div class="contact-label">Chat Now</div>
                <div class="contact-value">Live Support</div>
              </div>
            </div>
            <div class="contact-item">
              <div class="contact-icon">
                <i class="bi bi-telephone"></i>
              </div>
              <div class="contact-info">
                <div class="contact-label">Call Us</div>
                <div class="contact-value">800-580-4489</div>
              </div>
            </div>
            <div class="contact-item">
              <div class="contact-icon">
                <i class="bi bi-truck"></i>
              </div>
              <div class="contact-info">
                <div class="contact-label">Order</div>
                <div class="contact-value">Tracking</div>
              </div>
            </div>
          </div>
          <div class="user-actions d-flex align-items-center gap-2 ms-3">
            <a routerLink="/account" class="action-btn">
              <i class="bi bi-person-circle"></i>
            </a>
            <a routerLink="/cart" class="action-btn position-relative">
              <i class="bi bi-bag"></i>
              <span class="cart-badge" *ngIf="cartItems > 0">{{cartItems}}</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<!-- Navigation Menu -->
<nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom sticky-top">
  <div class="container-fluid">
    <!-- Mobile Menu Toggle -->
    <button class="navbar-toggler d-lg-none border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu">
      <i class="bi bi-list fs-4"></i>
    </button>

    <div class="collapse navbar-collapse">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item dropdown custom-nav-dropdown" *ngFor="let item of header">
          <a class="nav-link custom-nav-link" 
             [routerLink]="['/product-list', item.slug]" 
             [queryParams]="{ cat_url: item._id }"
             [class.dropdown-toggle]="item.subCatArray.length > 0"
             role="button" 
             [attr.data-bs-toggle]="item.subCatArray.length > 0 ? 'dropdown' : null">
            {{ item.name }}
          </a>
          <ul class="dropdown-menu custom-nav-dropdown-menu shadow-lg" *ngIf="item.subCatArray.length > 0">
            <li *ngFor="let subItem of item.subCatArray">
              <a class="dropdown-item custom-nav-dropdown-item" 
                 [routerLink]="['/product-list', subItem.slug]" 
                 [queryParams]="{ sub_cat: subItem._id }">
                {{ subItem.name }}
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Enhanced Mobile Offcanvas Menu -->
<div class="offcanvas offcanvas-start custom-offcanvas" tabindex="-1" id="mobileMenu">
  <div class="offcanvas-header border-bottom">
    <h5 class="offcanvas-title fw-bold">
      <i class="bi bi-list me-2"></i>
      Menu
    </h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body p-0">
    <div class="mobile-menu-list">
      <div class="mobile-menu-item" *ngFor="let item of header; let i = index">
        <div class="mobile-menu-header" 
             [class.has-submenu]="item.subCatArray.length > 0"
             (click)="toggleMobileSubmenu(i)">
          <a [routerLink]="['/product-list', item.slug]" 
             [queryParams]="{ cat_url: item._id }"
             class="mobile-menu-link">
            {{ item.name }}
          </a>
          <button class="mobile-submenu-toggle" 
                  *ngIf="item.subCatArray.length > 0"
                  [class.active]="mobileSubmenuOpen[i]">
            <i class="bi bi-chevron-down"></i>
          </button>
        </div>
        <div class="mobile-submenu" 
             *ngIf="item.subCatArray.length > 0"
             [class.show]="mobileSubmenuOpen[i]">
          <a *ngFor="let subItem of item.subCatArray"
             [routerLink]="['/product-list', subItem.slug]" 
             [queryParams]="{ sub_cat: subItem._id }"
             class="mobile-submenu-link">
            {{ subItem.name }}
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
